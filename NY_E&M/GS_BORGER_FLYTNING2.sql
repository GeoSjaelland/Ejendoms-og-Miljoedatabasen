SELECT
				AA70100T.KOMMUNENUMMER AS Kommunenummer,
				AA70100T.PERSONNUMMER AS Personnummer,
				udf_FormatCPR(AA70100T.PERSONNUMMER) AS CPR,
				AA70000T.FØDSEL_DATO AS Fødselsdato,
				CONVERT(INT, DATEDIFF(d, AA70000T.FØDSEL_DATO, GETDATE()) / 365.25) AS Alder,
				CAST(RTRIM(REVERSE(REPLACE(SUBSTRING(REVERSE(AA70000T.ADRESSERINGSNAVN), 1, CHARINDEX(',', REVERSE(AA70000T.ADRESSERINGSNAVN))), ',', ''))) + ' ' + REPLACE(SUBSTRING(AA70000T.ADRESSERINGSNAVN, 1, CHARINDEX(',', AA70000T.ADRESSERINGSNAVN)), ',', '') AS VARCHAR(50)) AS Navn,
				AA70100T.CO_NAVN,
				CAST(RTRIM(JY72000V.VEJADRNAVN + ' ' + REPLACE(LTRIM(REPLACE(RTRIM(JY72000V.HUS_NR), '0', ' ')), ' ', '0') + ' ' + RTRIM(LTRIM(AA70100T.ETAGE)) + ' ' + RTRIM(LTRIM(AA70100T.SIDE_DØRNR))) AS VARCHAR(50)) AS Adresse,
				JY72000V.SUPBYNAVN AS Supplerende_bynavn,
				JY72000V.POSTNR AS Postnummer, JY72000V.POSTBYNAVN AS Bynavn,
				CAST(JY72000V.POSTNR AS VARCHAR(5)) + ' ' + JY72000V.POSTBYNAVN AS Postdistrikt,
				JY72000V.BYGNAVN AS Bygningsnavn,
				AA70100T.ADR_TILFLYT_TS AS Tilflytningsdato,
				AA70100T.ADR_FRAFLYT_TS AS Fraflytningsdato,
				AA70100T.KOM_TILFLYTDATO AS Kommunetilflytningsdato,
				AA70100T.KOM_FRAFLYTDATO AS Kommunefraflytningsdato,
				AA70000T.BORGERSTATUS_KODE, QL58900V.TEKST AS Borgerstatus,
				AA70100T.FRAFLYT_KOMMUNENR,
				QL60000V.TEKST AS Fraflytningskommune,
				AA70000T.LAND_KODE,
				QL59400V.TEKST AS Land,
				AA70000T.STATSB_RET_TS AS Statsborgerret_ændring,
				AA70000T.STATBORG_OPHØR_TS AS Statsborgerret_Ophør,
				CAST(dbo.AA70100T.KOMMUNENUMMER AS VARCHAR(3))+ RIGHT('0000' + CONVERT(VARCHAR, dbo.AA70100T.VEJ_KODE), 4) + RTRIM(dbo.AA70100T.HUS_NUMMER) AS ADRESSELINK_ID,
	      CAST(dbo.AA70100T.KOMMUNENUMMER AS VARCHAR(3)) + CAST(dbo.AA70100T.VEJ_KODE AS VARCHAR(4)) + RTRIM(dbo.AA70100T.HUS_NUMMER) AS ADRESSE_ID,
	      CAST(dbo.AA70100T.KOMMUNENUMMER AS VARCHAR(3)) + CAST(dbo.AA70100T.VEJ_KODE AS VARCHAR(4)) + RTRIM(dbo.AA70100T.HUS_NUMMER) + LTRIM(dbo.AA70100T.ETAGE) + LTRIM(dbo.AA70100T.SIDE_DØRNR) AS UDVadresseID
FROM
				QL59400V RIGHT OUTER JOIN
				AA70000T ON QL59400V.KODE = AA70000T.LAND_KODE LEFT OUTER JOIN
				QL58900V ON AA70000T.BORGERSTATUS_KODE = QL58900V.KODE RIGHT OUTER JOIN
				AA70100T LEFT OUTER JOIN
				JY72000V ON AA70100T.VEJ_KODE = JY72000V.VEJKODE AND AA70100T.KOMMUNENUMMER = JY72000V.KOMMUNENUMMER AND AA70100T.HUS_NUMMER = JY72000V.HUS_NR LEFT OUTER JOIN
				QL60000V ON AA70100T.FRAFLYT_KOMMUNENR = QL60000V.KODE ON AA70000T.PERSONNUMMER = AA70100T.PERSONNUMMER